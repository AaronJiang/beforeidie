<?php	require('header.php');	require_once('data_funs.inc');		if(!is_auth()){		page_jump('account_page_login.php');	}?><script type='text/javascript'>$(document).ready(function(){	$('body').prop('id', 'page-dynamic');		$(".followed-goal-item").hover(		function(){			$(this).find('.disfollow-cmd').fadeIn('fast');		},		function(){			$(this).find('.disfollow-cmd').fadeOut('fast');				}	);});</script><div id='dynamic-panel'>	<div id='dynamic-type-wap'>		<a class='dynamic-type dynamic-type-others' href='dynamic.php?type=others'>好友动态</a		><a class='dynamic-type dynamic-type-me' href='dynamic.php?type=me'>与我相关</a>	</div><?php	$userID = $_SESSION['valid_user_id'];	$dynamicType = isset($_REQUEST['type'])? $_REQUEST['type']: 'others';		if($dynamicType == 'others'){		//好友动态		$dyns = get_dynamics($userID);				foreach($dyns as $dyn){			echo "<div class='dynamic-item clearfix'>";						if($dyn['type'] == 'newLog'){				//若为 Log 相关的动态				echo "<img class='dynamic-poster-profile' src='./imgs/gravatar-140.png' />"					."<div class='dynamic-content-wap'>"						. "<p class='dynamic-header'>"									. "<a class='dynamic-goal-creater' href='person.php?userID=". $dyn['PosterID']. "'>". $dyn['Poster']. "</a>"							. " 在 "							. "<a href='goal_page_details.php?goalID=". $dyn['GoalID']. "' class='dynamic-goal-title'>". $dyn['GoalTitle']. "</a>"							. " 中写到："						. "</p>"						. "<p class='dynamic-title'>". $dyn['LogTitle']. "</p>"						. "<p class='dynamic-content'>". $dyn['LogContent']. "</p>"					. "</div>"					. "<p class='dynamic-time'>". $dyn['Time']. "</p>";			}			else if($dyn['type'] == 'newGoal'){				//若为 Goal 相关的动态				echo "<img class='dynamic-poster-profile' src='./imgs/gravatar-140.png' />"					."<div class='dynamic-content-wap'>" 						. "<p class='dynamic-header'>"								. "<a class='dynamic-goal-creater' href='person.php?userID=". $dyn['PosterID']. "'>". $dyn['Poster']. "</a>"							. " 设立目标 "							. "<a href='goal_page_details.php?goalID=". $dyn['GoalID']. "' class='dynamic-goal-title'>". $dyn['GoalTitle']. "</a>"						. "</p>"						. "<p class='dynamic-goal-reason'>". $dyn['GoalReason']. "</p>"					. "</div>"					. "<p class='dynamic-time'>". $dyn['Time']. "</p>";			}						echo "</div>";		}	}	else if($dynamicType == 'me'){		//与我相关		$dyns = get_dynamics_about_me($userID);		foreach($dyns as $dyn){			echo "<div class='dynamic-item clearfix'>";						if($dyn['type'] == 'newComment'){				//若为评论				echo "<img class='dynamic-poster-profile' src='./imgs/gravatar-140.png' />"					."<div class='dynamic-content-wap'>"						. "<p class='dynamic-header'>"							. "<a class='dynamic-goal-creater' href='person.php?userID=". $dyn['PosterID']. "'>". $dyn['Poster']. "</a>"							. " 在我的目标 "							. "<a href='goal_page_details.php?goalID=". $dyn['GoalID']. "' class='dynamic-goal-title'>". $dyn['GoalTitle']. "</a>"							. " 中评论了 "							. "<a>". $dyn['LogTitle']. "</a>"							. " :"						. "</p>"						. "<p class='dynamic-comments'>". $dyn['Comment']. "</p>"					. "</div>"					. "<p class='dynamic-time'>". $dyn['Time']. "</p>";			}			else if($dyn['type'] == 'newCheer'){				//若为鼓励				echo "<img class='dynamic-poster-profile' src='./imgs/gravatar-140.png' />"					."<div class='dynamic-content-wap'>" 						."<p class='dynamic-header'>"							. "<a class='dynamic-goal-creater' href='person.php?userID=". $dyn['PosterID']. "'>". $dyn['Poster']. "</a>"							. " 鼓励了我的目标 "							. "<a href='goal_page_details.php?goalID=". $dyn['GoalID']. "' class='dynamic-goal-title'>". $dyn['GoalTitle']. "</a>"						. "</p>"					. "</div>"					. "<p class='dynamic-time'>". $dyn['Time']. "</p>";			}						echo "</div>";			}	}?></div><div id='dynamic-sidebar-panel'>	<!-- 个人关注 -->	<div class='panel-header'>		<div class='panel-title'>我的关注</div		><div class='panel-cmd-wapper'>......（<span class='panel-cmd' id='cmd-add-log'>管理</span>）</div>	</div>		<?php 		$followedUsers = get_followed_users($userID);				foreach($followedUsers as $user){			echo "<div class='followee-item clearfix'>"					. "<a href='person.php?userID=". $user['UserID'] ."'><img class='followee-profile' src='./imgs/gravatar-140.png' /><a>"					. "<div class='followee-info-wap'>"						. "<a class='followee-name' href='person.php?userID=". $user['UserID'] ."'>". $user['Username']. "</a>"						. "<div class='followee-goals-info-wap'>"							. "<span><b>". get_goal_num($user['UserID'], 'now'). "</b> 进行"							. " | "							. "<span><b>". get_goal_num($user['UserID'], 'future'). "</b> 待启"							. " | "							. "<span><b>". get_goal_num($user['UserID'], 'finish'). "</b> 完成"						. "</div>"					. "</div>"				. "</div>";		}	?></div><?php	require('footer.php');?>